
## 5.3 API仕様書

### 概要
システムの内外とのインターフェースのうち、APIを定義するドキュメントです。

**作成タイミング:**
- アーキテクチャ設計書、データ設計書の後
- 機能詳細仕様書と並行して作成
- 相互に参照し合う関係

### 記載項目

#### 5.3.0 更新履歴
- **記載内容:** このドキュメントをだれがいつなにを更新したかを記述(CHANGELOG相当)

#### 5.3.1 API概要
- **記載内容:** API全体の方針
- **ベースURL:** API のベースとなるURL
- **バージョニング方針:** APIバージョンの管理方法（URL、ヘッダー等）
- **認証方式:** API全体で使用する認証方式（OAuth 2.0, JWT, API Key等）
- **共通レスポンス形式:** 成功・エラー時の共通構造
- **レート制限:** リクエスト数の制限（ある場合）

#### 5.3.2 エンドポイント定義
- **記載内容:** 各APIエンドポイントの詳細
- 各APIについて:
  - **エンドポイントID:** 識別子（例: API-001）
  - **エンドポイント:** URL パス（例: `/api/v1/users/{userId}`）
  - **HTTPメソッド:** GET / POST / PUT / PATCH / DELETE
  - **概要:** このAPIが何をするか
  - **対応する要件ID:** トレーサビリティの確保
  - **認証:** 必要な認証・認可レベル
  - **リクエスト:**
    - **パスパラメータ:** URL内の変数
    - **クエリパラメータ:** URLの?以降のパラメータ
    - **リクエストヘッダー:** 必要なHTTPヘッダー
    - **リクエストボディ:** POSTやPUTで送信するデータ
      - データ構造（JSONスキーマ等）
      - 各フィールドのデータ型
      - 必須/任意の区別
      - バリデーションルール
  - **レスポンス:**
    - **成功時（200, 201等）:**
      - ステータスコード
      - レスポンスヘッダー
      - レスポンスボディ
        - データ構造
        - 各フィールドの説明
    - **エラー時（400, 401, 404, 500等）:**
      - 各ステータスコードの発生条件
      - エラーレスポンスの構造
      - エラーコード
      - エラーメッセージ
  - **サンプルリクエスト:** 実際の使用例（curlコマンド等）
  - **サンプルレスポンス:** 実際のレスポンス例

#### 5.3.3 内部API仕様（関数/メソッド）
- **記載内容:** アプリケーション内部の関数・メソッドのインターフェース
- 公開APIとして設計されたモジュール間のインターフェース
- 各関数について:
  - **関数ID:** 識別子
  - **関数名:** 関数・メソッド名
  - **概要:** この関数が何をするか
  - **引数:**
    - 引数名
    - データ型
    - 必須/任意
    - デフォルト値
    - 説明
  - **戻り値:**
    - データ型
    - 説明
  - **例外/エラー:** 発生しうる例外とその条件
  - **副作用:** DBへの書き込み、ファイル生成、外部API呼び出しなど

